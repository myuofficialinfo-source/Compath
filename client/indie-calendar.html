<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>„Ç§„É≥„Éá„Ç£„Éº„É™„É™„Éº„Çπ„Ç´„É¨„É≥„ÉÄ„Éº - Indie Release Calendar</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%238b5cf6%22 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><rect x=%223%22 y=%224%22 width=%2218%22 height=%2218%22 rx=%222%22/><line x1=%2216%22 y1=%222%22 x2=%2216%22 y2=%226%22/><line x1=%228%22 y1=%222%22 x2=%228%22 y2=%226%22/><line x1=%223%22 y1=%2210%22 x2=%2221%22 y2=%2210%22/></svg>">

    <!-- OGP -->
    <meta property="og:title" content="„Ç§„É≥„Éá„Ç£„Éº„É™„É™„Éº„Çπ„Ç´„É¨„É≥„ÉÄ„Éº">
    <meta property="og:description" content="„Ç§„É≥„Éá„Ç£„Éº„Ç≤„Éº„É†„ÅÆ„É™„É™„Éº„Çπ‰∫àÂÆöÊó•„ÇíÁ¢∫Ë™ç„ÄÇÈñãÁô∫ËÄÖÂêåÂ£´„ÅÆ„Éê„ÉÉ„ÉÜ„Ç£„É≥„Ç∞„ÇíÂõûÈÅø„Åó„Çà„ÅÜ„ÄÇ">
    <meta property="og:type" content="website">

    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18.2.0/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js" crossorigin></script>

    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        slate: { 850: '#15202e', 950: '#020617' }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
        }

        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #0f172a;
        }

        ::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 4px;
        }

        .animate-fade-in {
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        html {
            scroll-behavior: smooth;
        }
    </style>
</head>

<body class="bg-slate-950 text-slate-200 antialiased min-h-screen overflow-x-hidden">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect, useCallback } = React;

        // i18n
        const getLanguage = () => {
            try {
                const urlParams = new URLSearchParams(window.location.search);
                const urlLang = urlParams.get('lang');
                if (urlLang) return urlLang;
            } catch (e) {}
            return 'ja';
        };

        const i18n = {
            ja: {
                title: '„Ç§„É≥„Éá„Ç£„Éº„É™„É™„Éº„Çπ„Ç´„É¨„É≥„ÉÄ„Éº',
                subtitle: '„Ç§„É≥„Éá„Ç£„Éº„Ç≤„Éº„É†„ÅÆÁô∫Â£≤‰∫àÂÆöÊó•„Çí„ÉÅ„Çß„ÉÉ„ÇØ',
                loading: 'Ë™≠„ÅøËæº„Åø‰∏≠...',
                error: '„Éá„Éº„Çø„ÅÆÂèñÂæó„Å´Â§±Êïó„Åó„Åæ„Åó„Åü',
                retry: 'ÂÜçË©¶Ë°å',
                noGames: '„Åì„ÅÆÊúà„Å´„É™„É™„Éº„Çπ‰∫àÂÆö„ÅÆ„Ç≤„Éº„É†„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì',
                today: '‰ªäÊó•',
                games: '‰ª∂',
                viewOnSteam: 'Steam„ÅßË¶ã„Çã',
                free: 'ÁÑ°Êñô',
                priceUndecided: '‰æ°Ê†ºÊú™ÂÆö',
                releaseUndecided: 'Áô∫Â£≤Êó•Êú™ÂÆö',
                sun: 'Êó•', mon: 'Êúà', tue: 'ÁÅ´', wed: 'Ê∞¥', thu: 'Êú®', fri: 'Èáë', sat: 'Âúü',
                filterByPrice: '‰æ°Ê†º„Éï„Ç£„É´„Çø',
                allPrices: '„Åô„Åπ„Å¶',
                freeOnly: 'ÁÑ°Êñô',
                range1000: '~¬•1,000',
                range2000: '¬•1,001~2,000',
                range3000: '¬•2,001~3,000',
                listView: '„É™„Çπ„Éà',
                calendarView: '„Ç´„É¨„É≥„ÉÄ„Éº'
            },
            en: {
                title: 'Indie Release Calendar',
                subtitle: 'Check upcoming indie game releases',
                loading: 'Loading...',
                error: 'Failed to fetch data',
                retry: 'Retry',
                noGames: 'No games releasing this month',
                today: 'Today',
                games: 'games',
                viewOnSteam: 'View on Steam',
                free: 'Free',
                priceUndecided: 'Price TBD',
                releaseUndecided: 'TBD',
                sun: 'Sun', mon: 'Mon', tue: 'Tue', wed: 'Wed', thu: 'Thu', fri: 'Fri', sat: 'Sat',
                filterByPrice: 'Price Filter',
                allPrices: 'All',
                freeOnly: 'Free',
                range1000: '~¬•1,000',
                range2000: '¬•1,001~2,000',
                range3000: '¬•2,001~3,000',
                listView: 'List',
                calendarView: 'Calendar'
            }
        };

        // ChevronLeft Icon
        const ChevronLeft = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m15 18-6-6 6-6"/>
            </svg>
        );

        // ChevronRight Icon
        const ChevronRight = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m9 18 6-6-6-6"/>
            </svg>
        );

        // Calendar Icon
        const CalendarIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <rect width="18" height="18" x="3" y="4" rx="2" ry="2"/>
                <line x1="16" x2="16" y1="2" y2="6"/>
                <line x1="8" x2="8" y1="2" y2="6"/>
                <line x1="3" x2="21" y1="10" y2="10"/>
            </svg>
        );

        // List Icon
        const ListIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="8" x2="21" y1="6" y2="6"/>
                <line x1="8" x2="21" y1="12" y2="12"/>
                <line x1="8" x2="21" y1="18" y2="18"/>
                <line x1="3" x2="3.01" y1="6" y2="6"/>
                <line x1="3" x2="3.01" y1="12" y2="12"/>
                <line x1="3" x2="3.01" y1="18" y2="18"/>
            </svg>
        );

        // External Link Icon
        const ExternalLink = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                <polyline points="15 3 21 3 21 9"/>
                <line x1="10" x2="21" y1="14" y2="3"/>
            </svg>
        );

        // Game Detail Modal
        const GameDetailModal = ({ game, onClose, t }) => {
            if (!game) return null;

            return (
                <div
                    className="fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4"
                    onClick={onClose}
                >
                    <div
                        className="bg-slate-900 rounded-xl max-w-lg w-full overflow-hidden shadow-2xl border border-slate-700 animate-fade-in"
                        onClick={e => e.stopPropagation()}
                    >
                        <div className="relative bg-slate-800">
                            <img
                                src={game.headerImage}
                                alt={game.name}
                                className="w-full h-48 object-cover"
                                onError={(e) => {
                                    // Âà•„ÅÆÁîªÂÉè„Çµ„Ç§„Ç∫„ÇíË©¶„Åô
                                    if (!e.target.dataset.tried) {
                                        e.target.dataset.tried = '1';
                                        e.target.src = `https://cdn.cloudflare.steamstatic.com/steam/apps/${game.appid}/capsule_616x353.jpg`;
                                    } else if (e.target.dataset.tried === '1') {
                                        e.target.dataset.tried = '2';
                                        e.target.src = `https://cdn.cloudflare.steamstatic.com/steam/apps/${game.appid}/library_600x900.jpg`;
                                    } else {
                                        // ÂÖ®„Å¶Â§±Êïó„Åó„ÅüÂ†¥Âêà„ÅØ„Éó„É¨„Éº„Çπ„Éõ„É´„ÉÄ„Éº
                                        e.target.style.display = 'none';
                                    }
                                }}
                            />
                            <div className="absolute inset-0 flex items-center justify-center pointer-events-none">
                                <div className="text-6xl opacity-20">üéÆ</div>
                            </div>
                            <button
                                onClick={onClose}
                                className="absolute top-2 right-2 w-8 h-8 bg-black/50 rounded-full flex items-center justify-center text-white hover:bg-black/70 z-10"
                            >
                                √ó
                            </button>
                        </div>

                        <div className="p-4">
                            <h3 className="font-bold text-lg text-white mb-2">{game.name}</h3>

                            <div className="flex items-center gap-4 mb-4">
                                <div className="flex items-center gap-2 text-slate-400">
                                    <CalendarIcon />
                                    <span>{game.releaseDateText || t.releaseUndecided}</span>
                                </div>
                                <span className={`px-2 py-1 rounded text-sm font-bold ${
                                    game.price === 0
                                        ? 'bg-green-600/20 text-green-400'
                                        : 'bg-violet-600/20 text-violet-400'
                                }`}>
                                    {game.price === 0 ? t.free : `¬•${game.price.toLocaleString()}`}
                                </span>
                            </div>

                            <a
                                href={`https://store.steampowered.com/app/${game.appid}`}
                                target="_blank"
                                rel="noopener noreferrer"
                                className="flex items-center justify-center gap-2 w-full py-3 px-4 rounded-lg text-white font-medium hover:opacity-90 transition-opacity bg-gradient-to-r from-blue-600 to-blue-800"
                            >
                                <ExternalLink />
                                {t.viewOnSteam}
                            </a>
                        </div>
                    </div>
                </div>
            );
        };

        // Main App
        const App = () => {
            const [language, setLanguage] = useState(getLanguage());
            const t = i18n[language] || i18n.ja;

            const [currentDate, setCurrentDate] = useState(new Date());
            const [games, setGames] = useState([]);
            const [isLoading, setIsLoading] = useState(true);
            const [error, setError] = useState(null);
            const [selectedGame, setSelectedGame] = useState(null);
            const [viewMode, setViewMode] = useState('calendar'); // 'calendar' or 'list'
            const [priceFilter, setPriceFilter] = useState('all');

            const monthNames = language === 'ja'
                ? ['1Êúà', '2Êúà', '3Êúà', '4Êúà', '5Êúà', '6Êúà', '7Êúà', '8Êúà', '9Êúà', '10Êúà', '11Êúà', '12Êúà']
                : ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];

            const weekDays = [t.sun, t.mon, t.tue, t.wed, t.thu, t.fri, t.sat];

            // Fetch games
            const fetchGames = useCallback(async () => {
                setIsLoading(true);
                setError(null);
                try {
                    const timestamp = Date.now();
                    const response = await fetch(`/api/indie-calendar/upcoming?_t=${timestamp}`);
                    if (!response.ok) throw new Error('Failed to fetch');
                    const data = await response.json();
                    const gameList = data.games || [];
                    // „Éá„Éê„ÉÉ„Ç∞: ÊúàÂà•„Ç≤„Éº„É†Êï∞„ÇíË°®Á§∫
                    const monthCounts = {};
                    gameList.forEach(g => {
                        if (g.releaseDate) {
                            const ym = g.releaseDate.substring(0, 7);
                            monthCounts[ym] = (monthCounts[ym] || 0) + 1;
                        }
                    });
                    console.log('[IndieCalendar] ÊúàÂà•„Ç≤„Éº„É†Êï∞:', monthCounts);
                    console.log('[IndieCalendar] Á∑è„Ç≤„Éº„É†Êï∞:', gameList.length);
                    setGames(gameList);
                } catch (err) {
                    setError(err.message);
                } finally {
                    setIsLoading(false);
                }
            }, []);

            useEffect(() => {
                fetchGames();
            }, [fetchGames]);

            // Filter games by price
            const filteredGames = useMemo(() => {
                return games.filter(game => {
                    if (priceFilter === 'all') return true;
                    if (priceFilter === 'free') return game.price === 0;
                    if (priceFilter === 'range1000') return game.price > 0 && game.price <= 1000;
                    if (priceFilter === 'range2000') return game.price > 1000 && game.price <= 2000;
                    if (priceFilter === 'range3000') return game.price > 2000 && game.price <= 3000;
                    return true;
                });
            }, [games, priceFilter]);

            // Get games for current month
            const currentMonthGames = useMemo(() => {
                const year = currentDate.getFullYear();
                const month = currentDate.getMonth() + 1;
                const yearMonth = `${year}-${String(month).padStart(2, '0')}`;
                return filteredGames.filter(g => g.releaseDate && g.releaseDate.startsWith(yearMonth));
            }, [filteredGames, currentDate]);

            // Format date to YYYY-MM-DD
            const formatDateKey = (date) => {
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                return `${year}-${month}-${day}`;
            };

            // Generate calendar days
            const calendarDays = useMemo(() => {
                const year = currentDate.getFullYear();
                const month = currentDate.getMonth();
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const today = new Date();
                today.setHours(0, 0, 0, 0);

                const days = [];

                // Days from previous month
                const startDayOfWeek = firstDay.getDay();
                for (let i = startDayOfWeek - 1; i >= 0; i--) {
                    const date = new Date(year, month, -i);
                    days.push({
                        date,
                        day: date.getDate(),
                        isCurrentMonth: false,
                        isToday: false,
                        dateStr: formatDateKey(date)
                    });
                }

                // Days of current month
                for (let day = 1; day <= lastDay.getDate(); day++) {
                    const date = new Date(year, month, day);
                    days.push({
                        date,
                        day,
                        isCurrentMonth: true,
                        isToday: date.getTime() === today.getTime(),
                        dateStr: formatDateKey(date)
                    });
                }

                // Days from next month
                const remainingDays = 42 - days.length; // 6 weeks
                for (let i = 1; i <= remainingDays; i++) {
                    const date = new Date(year, month + 1, i);
                    days.push({
                        date,
                        day: i,
                        isCurrentMonth: false,
                        isToday: false,
                        dateStr: formatDateKey(date)
                    });
                }

                return days;
            }, [currentDate]);

            // Get games for specific date
            const getGamesForDate = (dateStr) => {
                return filteredGames.filter(g => g.releaseDate === dateStr);
            };

            // Navigation
            const navigateMonth = (direction) => {
                setCurrentDate(prev => {
                    const newDate = new Date(prev);
                    newDate.setMonth(newDate.getMonth() + direction);
                    return newDate;
                });
            };

            const goToToday = () => {
                setCurrentDate(new Date());
            };

            return (
                <div className="min-h-screen bg-slate-950">
                    {/* „Éò„ÉÉ„ÉÄ„Éº */}
                    <header className="flex items-center justify-between px-6 py-3 bg-slate-900 border-b border-slate-800 sticky top-0 z-50">
                        <div className="flex items-center gap-4">
                            <a
                                href="/"
                                className="flex items-center justify-center w-10 h-10 bg-slate-800 border border-slate-700 rounded-lg text-slate-400 hover:bg-slate-700 hover:text-white hover:border-violet-500 transition"
                                title={language === 'ja' ? '„Éõ„Éº„É†„Å´Êàª„Çã' : 'Back to Home'}
                            >
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                                </svg>
                            </a>
                            <h1 className="text-xl font-semibold text-white">{t.title}</h1>
                        </div>
                        <div className="flex items-center gap-1 bg-slate-800 border border-slate-700 rounded-full p-1">
                            <button
                                onClick={() => setLanguage('ja')}
                                className={`px-3 py-1.5 text-sm font-medium rounded-full transition ${
                                    language === 'ja' ? 'bg-violet-600 text-white' : 'text-slate-400 hover:text-white'
                                }`}
                            >
                                Êó•Êú¨Ë™û
                            </button>
                            <button
                                onClick={() => setLanguage('en')}
                                className={`px-3 py-1.5 text-sm font-medium rounded-full transition ${
                                    language === 'en' ? 'bg-violet-600 text-white' : 'text-slate-400 hover:text-white'
                                }`}
                            >
                                EN
                            </button>
                        </div>
                    </header>

                    <main className="max-w-7xl mx-auto p-6">
                        {/* Controls */}
                        <div className="flex flex-col sm:flex-row items-center justify-between gap-4 mb-6">
                            {/* Month Navigation */}
                            <div className="flex items-center gap-2 sm:gap-4">
                                <button
                                    onClick={() => navigateMonth(-1)}
                                    className="p-2 rounded-lg bg-slate-800 hover:bg-slate-700 transition"
                                >
                                    <ChevronLeft />
                                </button>
                                <h2 className="text-lg sm:text-2xl font-bold text-white min-w-[140px] sm:min-w-[200px] text-center">
                                    {currentDate.getFullYear()}{language === 'ja' ? 'Âπ¥' : ''} {monthNames[currentDate.getMonth()]}
                                </h2>
                                <button
                                    onClick={() => navigateMonth(1)}
                                    className="p-2 rounded-lg bg-slate-800 hover:bg-slate-700 transition"
                                >
                                    <ChevronRight />
                                </button>
                            </div>

                            <div className="flex items-center gap-2 flex-wrap justify-center">
                                {/* View Toggle */}
                                <div className="flex items-center bg-slate-800 rounded-lg p-1">
                                    <button
                                        onClick={() => setViewMode('calendar')}
                                        className={`flex items-center gap-1 px-3 py-1.5 rounded-md text-sm font-medium transition ${
                                            viewMode === 'calendar' ? 'bg-violet-600 text-white' : 'text-slate-400 hover:text-white'
                                        }`}
                                    >
                                        <CalendarIcon />
                                        <span className="hidden sm:inline">{t.calendarView}</span>
                                    </button>
                                    <button
                                        onClick={() => setViewMode('list')}
                                        className={`flex items-center gap-1 px-3 py-1.5 rounded-md text-sm font-medium transition ${
                                            viewMode === 'list' ? 'bg-violet-600 text-white' : 'text-slate-400 hover:text-white'
                                        }`}
                                    >
                                        <ListIcon />
                                        <span className="hidden sm:inline">{t.listView}</span>
                                    </button>
                                </div>

                                <button
                                    onClick={goToToday}
                                    className="px-4 py-2 text-sm font-medium rounded-lg bg-slate-800 hover:bg-slate-700 transition"
                                >
                                    {t.today}
                                </button>
                            </div>
                        </div>

                        {/* Price Filter */}
                        <div className="mb-6">
                            <div className="flex items-center gap-2 flex-wrap">
                                <span className="text-slate-400 text-sm">{t.filterByPrice}:</span>
                                {[
                                    { key: 'all', label: t.allPrices },
                                    { key: 'free', label: t.freeOnly },
                                    { key: 'range1000', label: t.range1000 },
                                    { key: 'range2000', label: t.range2000 },
                                    { key: 'range3000', label: t.range3000 }
                                ].map(option => (
                                    <button
                                        key={option.key}
                                        onClick={() => setPriceFilter(option.key)}
                                        className={`px-3 py-1 rounded-full text-xs font-medium transition ${
                                            priceFilter === option.key
                                                ? 'bg-violet-600 text-white'
                                                : 'bg-slate-800 text-slate-400 hover:bg-slate-700'
                                        }`}
                                    >
                                        {option.label}
                                    </button>
                                ))}
                            </div>
                        </div>

                        {/* Stats */}
                        <div className="mb-4 text-slate-400 text-sm">
                            {currentMonthGames.length} {t.games}
                        </div>

                        {/* Error State */}
                        {error && (
                            <div className="text-center py-12">
                                <div className="text-4xl mb-4">‚ö†Ô∏è</div>
                                <p className="text-slate-400 mb-4">{t.error}</p>
                                <button
                                    onClick={fetchGames}
                                    className="px-4 py-2 bg-violet-600 text-white rounded-lg hover:bg-violet-700 transition"
                                >
                                    {t.retry}
                                </button>
                            </div>
                        )}

                        {/* Loading State */}
                        {isLoading && (
                            <div className="text-center py-12">
                                <svg className="animate-spin h-10 w-10 mx-auto mb-4 text-violet-500" viewBox="0 0 24 24">
                                    <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4" fill="none"/>
                                    <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"/>
                                </svg>
                                <p className="text-slate-400">{t.loading}</p>
                            </div>
                        )}

                        {/* Calendar View */}
                        {!isLoading && !error && viewMode === 'calendar' && (
                            <div className="bg-slate-900/50 rounded-xl border border-slate-800 overflow-hidden">
                                {/* Week day headers */}
                                <div className="grid grid-cols-7 border-b border-slate-700">
                                    {weekDays.map((day, index) => (
                                        <div
                                            key={day}
                                            className={`py-3 text-center text-sm font-medium ${
                                                index === 0 ? 'text-red-400' :
                                                index === 6 ? 'text-blue-400' :
                                                'text-slate-400'
                                            }`}
                                        >
                                            {day}
                                        </div>
                                    ))}
                                </div>

                                {/* Calendar grid */}
                                <div className="grid grid-cols-7">
                                    {calendarDays.map((day, index) => {
                                        const dayGames = getGamesForDate(day.dateStr);
                                        const dayOfWeek = day.date.getDay();

                                        return (
                                            <div
                                                key={index}
                                                className={`min-h-[100px] sm:min-h-[120px] p-1 sm:p-2 border-b border-r border-slate-800 ${
                                                    !day.isCurrentMonth ? 'opacity-30' : ''
                                                } ${day.isToday ? 'bg-violet-900/20 ring-2 ring-inset ring-violet-500' : ''}`}
                                            >
                                                <div className={`text-sm font-bold mb-1 ${
                                                    dayOfWeek === 0 ? 'text-red-400' :
                                                    dayOfWeek === 6 ? 'text-blue-400' :
                                                    'text-slate-300'
                                                }`}>
                                                    {day.day}
                                                </div>

                                                <div className="space-y-1 max-h-[70px] sm:max-h-[90px] overflow-y-auto">
                                                    {dayGames.slice(0, 3).map(game => (
                                                        <div
                                                            key={game.appid}
                                                            onClick={() => setSelectedGame(game)}
                                                            className="px-1 py-0.5 bg-violet-600/80 hover:bg-violet-600 rounded text-[9px] sm:text-[10px] text-white truncate cursor-pointer transition"
                                                            title={game.name}
                                                        >
                                                            {game.name}
                                                        </div>
                                                    ))}
                                                    {dayGames.length > 3 && (
                                                        <div className="text-[9px] text-slate-500 px-1">
                                                            +{dayGames.length - 3} more
                                                        </div>
                                                    )}
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>
                        )}

                        {/* List View */}
                        {!isLoading && !error && viewMode === 'list' && (
                            <div className="space-y-4">
                                {currentMonthGames.length === 0 ? (
                                    <div className="text-center py-12">
                                        <div className="text-4xl mb-4">üì≠</div>
                                        <p className="text-slate-400">{t.noGames}</p>
                                    </div>
                                ) : (
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                        {currentMonthGames.map(game => (
                                            <div
                                                key={game.appid}
                                                onClick={() => setSelectedGame(game)}
                                                className="bg-slate-800/50 rounded-lg overflow-hidden hover:bg-slate-800 transition cursor-pointer animate-fade-in border border-slate-700"
                                            >
                                                <div className="relative bg-slate-700 h-32">
                                                    <img
                                                        src={game.headerImage}
                                                        alt={game.name}
                                                        className="w-full h-32 object-cover relative z-10"
                                                        onError={(e) => {
                                                            if (!e.target.dataset.tried) {
                                                                e.target.dataset.tried = '1';
                                                                e.target.src = `https://cdn.cloudflare.steamstatic.com/steam/apps/${game.appid}/capsule_616x353.jpg`;
                                                            } else {
                                                                e.target.style.display = 'none';
                                                            }
                                                        }}
                                                    />
                                                    <div className="absolute inset-0 flex items-center justify-center">
                                                        <div className="text-4xl opacity-30">üéÆ</div>
                                                    </div>
                                                </div>
                                                <div className="p-3">
                                                    <h3 className="font-semibold text-white text-sm line-clamp-1 mb-2">
                                                        {game.name}
                                                    </h3>
                                                    <div className="flex items-center justify-between">
                                                        <span className="text-slate-400 text-xs flex items-center gap-1">
                                                            <CalendarIcon />
                                                            {game.releaseDateText || t.releaseUndecided}
                                                        </span>
                                                        <span className={`px-2 py-0.5 rounded text-xs font-bold ${
                                                            game.price === 0
                                                                ? 'bg-green-600/20 text-green-400'
                                                                : 'bg-slate-700 text-slate-300'
                                                        }`}>
                                                            {game.price === 0 ? t.free : `¬•${game.price.toLocaleString()}`}
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>
                        )}
                    </main>

                    {/* Game Detail Modal */}
                    <GameDetailModal
                        game={selectedGame}
                        onClose={() => setSelectedGame(null)}
                        t={t}
                    />
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
